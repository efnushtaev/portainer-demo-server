# NodeJS Portainer App Template

## Описание

Это шаблон простого fullstack-приложение, состоящее из фронтенда на React и бэкенда на Express.js. Приложение собирается и разворачивается с помощью Docker Compose и предназначено для деплоя через Portainer на виртуальной машине. Фронтенд периодически (каждые 10 секунд) запрашивает текущее время сервера через REST API.

## Архитектура

- **Frontend**: React-приложение, собирается в статические файлы и обслуживается через Nginx.
- **Backend**: Express.js сервер, отдающий текущее время по эндпоинту `/api/getTimestamp`.
- **Nginx**: Используется как обратный прокси для маршрутизации запросов между фронтендом и бэкендом.
- **Docker Compose**: Управляет сборкой и запуском всех сервисов.

## Конфигурация Nginx

Файл [nginx/nginx.conf](nginx/nginx.conf) настраивает Nginx следующим образом:

- Все статические файлы фронтенда обслуживаются из `/usr/share/nginx/html`.
- Запросы к `/api` проксируются на backend-сервис (`http://backend:3001`).
- Для остальных маршрутов используется SPA-режим (`try_files $uri $uri/ /index.html`).
- Для статики настроено кэширование на 1 год.
- Отключены server_tokens для безопасности.

## Конфигурация Docker

- **[Dockerfile.client](Dockerfile.client)**: Собирает фронтенд, копирует сборку в Nginx.
- **[Dockerfile.server](Dockerfile.server)**: Собирает и запускает backend на Node.js 18.
- **[docker-compose.yml](docker-compose.yml)**: Описывает два сервиса:
  - `frontend` — React + Nginx, порт 80.
  - `backend` — Express.js, порт 3001, с healthcheck.
- Все зависимости устанавливаются через `npm ci` для воспроизводимости сборки.
- Переменные окружения и порты настраиваются для продакшн-режима.

## Деплой

1. Клонируйте репозиторий в Portainer.
2. Запустите стек через docker-compose.
3. Приложение будет доступно по публичному IP виртуальной машины.

## Безопасность

- API доступен только через фронтенд (Nginx не проксирует /api наружу напрямую).
- Кэширование и отключение server_tokens повышают безопасность и производительность.